<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>NYTRO by LCSL</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>NYTRO</h1>
        <p>This Matlab package provides an implementation of NYTRO: NYstr√∂m iTerative RegularizatiOn</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/LCSL/NYTRO" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/LCSL/NYTRO/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/LCSL/NYTRO/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <hr>

<h1>
<a id="the-nytro-matlab-package" class="anchor" href="#the-nytro-matlab-package" aria-hidden="true"><span class="octicon octicon-link"></span></a>The NYTRO Matlab Package</h1>

<p><strong><em>NYstrom iTerative RegularizatiOn</em></strong></p>

<hr>

<p>Copyright (C) 2015, <a href="http://lcsl.mit.edu/#/home">Laboratory for Computational and Statistical Learning</a> (IIT@MIT).
All rights reserved.</p>

<p><em>By Raffaello Camoriano, Alessandro Rudi and Lorenzo Rosasco</em></p>

<p><em>Contact: <a href="mailto:raffaello.camoriano@iit.it">raffaello.camoriano@iit.it</a></em></p>

<p>Please check the attached license file.</p>

<h1>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h1>

<p>This Matlab package provides an implementation of the NYTRO algorithm presented in the following work:</p>

<blockquote>
<p><em>Tomas Angles, Raffaello Camoriano, Alessandro Rudi, Lorenzo Rosasco</em>, <strong><em>NYTRO: When Subsampling Meets Early Stopping</em></strong>, 19 Oct 2015, <a href="http://arxiv.org/abs/1510.05684">http://arxiv.org/abs/1510.05684</a></p>
</blockquote>

<p>Early stopping is a well known approach to reduce the time complexity for performing training and model selection of large scale learning machines. On the other hand, memory/space (rather than time) complexity is the main constraint in many applications, and randomized subsampling techniques have been proposed to tackle this issue. In NYTRO, we combine early stopping and subsampling ideas, proposing a form of randomized iterative regularization based on early stopping and subsampling. In this way, we overcome the memory bottle neck of exact Early Stopping algorithms such as the kernelized Landweber iteration. Moreover, NYTRO can also be faster than other subsampled algorithms, such as Nystrom Kernel Regularized Least Squares (NKRLS), especially when a stopping rule is used.</p>

<p>This software package provides a simple and extendible interface to NYTRO. It has been tested on MATLAB r2014b, but should work on newer and older versions too. If it does not, please contact us and/or open an issue. Examples are available  in the "examples" folder.</p>

<h1>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h1>

<h2>
<a id="automatic-training-with-default-options" class="anchor" href="#automatic-training-with-default-options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Automatic training with default options</h2>

<div class="highlight highlight-source-matlab"><pre>
<span class="pl-k">load</span> breastcancer

<span class="pl-c">% Perform default cross validation</span>
[ training_output ] = nytro_train( Xtr , Ytr );

<span class="pl-c">% Perform predictions on the test set and evaluate results</span>
[ prediction_output ] = nytro_test( Xtr , Xte , Yte , training_output);</pre></div>

<h2>
<a id="specifying-a-custom-kernel-parameter" class="anchor" href="#specifying-a-custom-kernel-parameter" aria-hidden="true"><span class="octicon octicon-link"></span></a>Specifying a custom kernel parameter</h2>

<div class="highlight highlight-source-matlab"><pre>
<span class="pl-k">load</span> breastcancer

<span class="pl-c">% Customize configuration</span>
config = config_set(<span class="pl-s"><span class="pl-pds">'</span>kernel.kernelParameters<span class="pl-pds">'</span></span> , <span class="pl-c1">0.9</span> , ...           <span class="pl-c">% Change gaussian kernel parameter (sigma)</span>
                    <span class="pl-s"><span class="pl-pds">'</span>kernel.kernelFunction<span class="pl-pds">'</span></span> , @gaussianKernel);     <span class="pl-c">% Change kernel function</span>

<span class="pl-c">% Perform default cross validation</span>
[ training_output ] = nytro_train( Xtr , Ytr , config);

<span class="pl-c">% Perform predictions on the test set and evaluate results</span>
[ prediction_output ] = nytro_test( Xtr , Xte , Yte , training_output);</pre></div>

<h2>
<a id="specifying-the-subsampling-level-m" class="anchor" href="#specifying-the-subsampling-level-m" aria-hidden="true"><span class="octicon octicon-link"></span></a>Specifying the subsampling level <em>m</em>
</h2>

<div class="highlight highlight-source-matlab"><pre>
<span class="pl-k">load</span> breastcancer

<span class="pl-c">% Customize configuration</span>
config = config_set(<span class="pl-s"><span class="pl-pds">'</span>kernel.m<span class="pl-pds">'</span></span> , <span class="pl-c1">200</span>);     <span class="pl-c">% Change kernel function</span>

<span class="pl-c">% Perform default cross validation</span>
[ training_output ] = nytro_train( Xtr , Ytr , config);

<span class="pl-c">% Perform predictions on the test set and evaluate results</span>
[ prediction_output ] = nytro_test( Xtr , Xte , Yte , training_output);</pre></div>

<h2>
<a id="some-more-customizations" class="anchor" href="#some-more-customizations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Some more customizations</h2>

<div class="highlight highlight-source-matlab"><pre>
<span class="pl-k">load</span> breastcancer

<span class="pl-c">% Customize configuration</span>
config = config_set(<span class="pl-s"><span class="pl-pds">'</span>crossValidation.threshold<span class="pl-pds">'</span></span> ,<span class="pl-k"> -</span><span class="pl-c1">0.002</span> , ...      <span class="pl-c">% Change stopping rule threshold</span>
                    <span class="pl-s"><span class="pl-pds">'</span>crossValidation.recompute<span class="pl-pds">'</span></span> , <span class="pl-c1">1</span> , ...           <span class="pl-c">% Recompute the solution after cross validation</span>
                    <span class="pl-s"><span class="pl-pds">'</span>crossValidation.codingFunction<span class="pl-pds">'</span></span> , @zeroOneBin , ...   <span class="pl-c">% Change coding function</span>
                    <span class="pl-s"><span class="pl-pds">'</span>crossValidation.errorFunction<span class="pl-pds">'</span></span> , @classificationError , ...   <span class="pl-c">% Change error function</span>
                    <span class="pl-s"><span class="pl-pds">'</span>crossValidation.stoppingRule<span class="pl-pds">'</span></span> , @windowSimple , ...   <span class="pl-c">% Change stopping rule function</span>
                    <span class="pl-s"><span class="pl-pds">'</span>kernel.m<span class="pl-pds">'</span></span> , <span class="pl-c1">200</span> , ...                          <span class="pl-c">% Modify the subsampling level (default m = 100)</span>
                    <span class="pl-s"><span class="pl-pds">'</span>kernel.kernelParameters<span class="pl-pds">'</span></span> , <span class="pl-c1">0.9</span> , ...           <span class="pl-c">% Change gaussian kernel parameter (sigma)</span>
                    <span class="pl-s"><span class="pl-pds">'</span>kernel.kernelFunction<span class="pl-pds">'</span></span> , @gaussianKernel);     <span class="pl-c">% Change kernel function</span>

<span class="pl-c">% Perform default cross validation</span>
[ training_output ] = nytro_train( Xtr , Ytr , config);

<span class="pl-c">% Perform predictions on the test set and evaluate results</span>
[ prediction_output ] = nytro_test( Xtr , Xte , Yte , training_output);</pre></div>

<p><strong>For a complete list of customizable configuration options, see the next section.</strong></p>

<h1>
<a id="configuration-parameters" class="anchor" href="#configuration-parameters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuration Parameters</h1>

<p>All the configurable parameters of the algorithm can be set by means of the provided <em>config_set</em> function, which returns a custom configuration structure that can be passed to the <em>nytro_train</em> function. If no configuration structure is passed, <em>nytro_train</em> uses the default configuration parameters listed below. <em>nytro_train</em> performs the training by running the NYTRO algorithm. It returns a structure with the trained model, which can then be passed to <em>nytro_test</em> for performing predictions and test error assessment.</p>

<p>This is an example of how the configuration parameters can be customized by means of the <em>config_set</em> function. See the code in "examples/customCrossValidation.m" for more details.</p>

<div class="highlight highlight-source-matlab"><pre><span class="pl-c">% Customize configuration</span>
config = config_set(<span class="pl-s"><span class="pl-pds">'</span>crossValidation.threshold<span class="pl-pds">'</span></span> ,<span class="pl-k"> -</span><span class="pl-c1">0.002</span> , ...      <span class="pl-c">% Change stopping rule threshold</span>
                    <span class="pl-s"><span class="pl-pds">'</span>crossValidation.recompute<span class="pl-pds">'</span></span> , <span class="pl-c1">1</span> , ...           <span class="pl-c">% Recompute the solution after cross validation</span>
                    <span class="pl-s"><span class="pl-pds">'</span>crossValidation.codingFunction<span class="pl-pds">'</span></span> , @zeroOneBin , ...   <span class="pl-c">% Change coding function</span>
                    <span class="pl-s"><span class="pl-pds">'</span>crossValidation.errorFunction<span class="pl-pds">'</span></span> , @classificationError , ...   <span class="pl-c">% Change error function</span>
                    <span class="pl-s"><span class="pl-pds">'</span>crossValidation.stoppingRule<span class="pl-pds">'</span></span> , @windowSimple , ...   <span class="pl-c">% Change stopping rule function</span>
                    <span class="pl-s"><span class="pl-pds">'</span>kernel.m<span class="pl-pds">'</span></span> , <span class="pl-c1">200</span> , ...                          <span class="pl-c">% Modify the subsampling level (default m = 100)</span>
                    <span class="pl-s"><span class="pl-pds">'</span>kernel.kernelParameters<span class="pl-pds">'</span></span> , <span class="pl-c1">0.9</span> , ...           <span class="pl-c">% Change kernel parameter (sigma)</span>
                    <span class="pl-s"><span class="pl-pds">'</span>kernel.kernelFunction<span class="pl-pds">'</span></span> , @gaussianKernel);     <span class="pl-c">% Change kernel function</span></pre></div>

<p><strong>The default configuration parametrs are reported below:</strong></p>

<ul>
<li>
<p><strong>Data</strong></p>

<ul>
<li>data.shuffle = 1</li>
</ul>
</li>
<li>
<p><strong>Cross Validation</strong></p>

<ul>
<li>crossValidation.storeTrainingError = 0</li>
<li>crossValidation.validationPart = 0.2</li>
<li>crossValidation.recompute = 0</li>
<li>crossValidation.errorFunction = @rmse

<ul>
<li>Provided functions (<em>errorFunctions</em> folder):

<ul>
<li>@rmse: root mean squared error</li>
<li>@classificationError : Relative classification error (error rate)</li>
</ul>
</li>
<li>Custom functions can be implemented by the user, simply following the input-output structure of any of the provided functions.</li>
</ul>
</li>
<li>crossValidation.codingFunction = [ ]

<ul>
<li>Provided functions (<em>codingFunctions</em> folder):

<ul>
<li>@plusMinusOneBin: Class 1: +1, class 2: -1</li>
<li>@zeroOneBin : Class 1: +1, class 2: 0</li>
</ul>
</li>
<li>Custom functions can be implemented by the user, simply following the input-output structure of any of the provided functions.</li>
</ul>
</li>
<li>crossValidation.stoppingRule = @windowLinearFitting

<ul>
<li>Provided functions (<em>stoppingRules</em> folder):

<ul>
<li>@windowSimple: Stops if the ratio e1/e0 &gt;= (1-threshold). e1 is the error of the most recent iteration. e0 is the error of the oldest iteration in the window</li>
<li>@windowAveraged : Works like @windowSimple, but taking e1 and e0 as the mean over the oldest and newest 10% of the points contained in the window (to increase stability).</li>
<li>@windowMedian : Works like @windowAveraged, but computes the median rather than the mean.</li>
<li>@windowLinearFitting : Works like @windowSimple, but uses a linear fitting of all the points in the window to obtain a more stable estimate of e0 and e1.</li>
</ul>
</li>
<li>Custom functions can be implemented by the user, simply following the input-output structure of any of the provided functions.</li>
</ul>
</li>
<li>crossValidation.windowSize = 10</li>
<li>crossValidation.threshold = 0</li>
</ul>
</li>
<li>
<p><strong>Filter</strong></p>

<ul>
<li>filter.fixedIterations  = [ ]</li>
<li>filter.maxIterations  = 500</li>
<li>filter.gamma  = [ ]</li>
</ul>
</li>
<li>
<p><strong>Kernel</strong></p>

<ul>
<li>kernel.kernelFunction  = @gaussianKernel

<ul>
<li>Provided functions:

<ul>
<li>@gaussianKernel : Gaussian kernel function. In this case, the kernel parameter is the bandwidth sigma.</li>
</ul>
</li>
<li>Custom functions can be implemented by the user, simply following the input-output structure of any of the provided functions.</li>
</ul>
</li>
<li>kernel.kernelParameters = 1</li>
<li>kernel.m = 100</li>
</ul>
</li>
</ul>

<h1>
<a id="output-structures" class="anchor" href="#output-structures" aria-hidden="true"><span class="octicon octicon-link"></span></a>Output structures</h1>

<h2>
<a id="nytro_train" class="anchor" href="#nytro_train" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>nytro_train</em>
</h2>

<ul>
<li>
<p>best.</p>

<ul>
<li>validationError : Best validation error found in cross validation</li>
<li>iteration : Best filter iteration</li>
<li>alpha : Best coefficients vector</li>
</ul>
</li>
<li><p>nysIdx : Vector - selected Nystrom training samples indexes</p></li>
<li>
<p>time.</p>

<ul>
<li>kernelComputation : Time for kernel computation</li>
<li>crossValidationTrain : Time for filter iterations during cross validation</li>
<li>crossValidationEval : Time for validation error evaluation during cross validation</li>
<li>crossValidationTotal : Cumulative cross validation time</li>
<li>fullTraining : Training time in the just-train case (no cross validation)</li>
</ul>
</li>
<li>
<p>errorPath.</p>

<ul>
<li>training : Training error path for each of the computed iterations</li>
<li>validation : Validation error path for each of the computed iterations</li>
</ul>
</li>
</ul>

<h2>
<a id="nytro_test" class="anchor" href="#nytro_test" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>nytro_test</em>
</h2>

<ul>
<li>YtePred : Predicted output</li>
<li>testError : Test error</li>
<li>time.

<ul>
<li>kernelComputation : Kernel computation time</li>
<li>prediction : Prediction computation time</li>
<li>errorComputation : Error computation time</li>
</ul>
</li>
</ul>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/LCSL">LCSL</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
